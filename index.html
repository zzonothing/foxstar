<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <title>캐릭터 스탯 테이블</title>
    <style>
        table {
            width: 80%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        table,
        th,
        td {
            border: 1px solid #ccc;
        }

        th,
        td {
            padding: 8px;
            text-align: center;
        }
    </style>
</head>

<body>
    <h1>캐릭터 스탯 조회</h1>
    <!-- 캐릭터 선택 드롭다운 -->
    <label for="characterSelect">캐릭터 선택: </label>
    <select id="characterSelect">
        <option value="">-- 선택하세요 --</option>
    </select>

    <!-- 스탯 출력 테이블 -->
    <table id="statsTable">
        <thead>
            <tr>
                <th>닉네임</th>
                <th>우코 파워</th>
                <th>비우코 파워</th>
                <th>우코</th>
                <th>공증</th>
                <th>공격력</th>                
                <th>스킬1</th>
                <th>스킬2</th>
                <th>스킬3</th>
            </tr>
        </thead>
        <tbody>
            <!-- JavaScript로 동적 생성 -->
        </tbody>
    </table>

    <script>
        // data.json 파일을 불러오기
        fetch('data/data.json')
            .then(response => response.json())
            .then(data => {
                const members = data.members;

                // 모든 멤버의 Characters 배열에서 고유 캐릭터 이름을 추출
                const characterNamesSet = new Set();
                members.forEach(member => {
                    member.Characters.forEach(character => {
                        characterNamesSet.add(character.name);
                    });
                });
                const characterNames = Array.from(characterNamesSet);

                // 드롭다운 메뉴에 캐릭터 이름 추가
                const select = document.getElementById('characterSelect');
                characterNames.forEach(name => {
                    const option = document.createElement('option');
                    option.value = name;
                    option.textContent = name;
                    select.appendChild(option);
                });

                // 캐릭터 선택 시 테이블 업데이트
                select.addEventListener('change', function () {
                    const selectedName = this.value;
                    const tbody = document.getElementById('statsTable').querySelector('tbody');
                    tbody.innerHTML = ''; // 기존 테이블 내용 초기화

                    // 각 멤버에 대해 해당 캐릭터 데이터가 있는지 확인
                    members.forEach(member => {
                        // 멤버의 Characters 배열에서 선택한 캐릭터 검색
                        const character = member.Characters.find(c => c.name === selectedName);
                        if (character) {
                            const tr = document.createElement('tr');

                            // 멤버 이름
                            const tdMember = document.createElement('td');
                            tdMember.textContent = member.name;
                            tr.appendChild(tdMember);
                            
                            // 우코 파워
                            const tdElementPower = document.createElement('td');
                            tdElementPower.textContent =
                                Math.round(character.atk * (1 + character.increaseAtk/100) * (1 + character.increaseElementDamage/100));
                            tr.appendChild(tdElementPower);

                            // 비우코 파워
                            const tdNonElementPower = document.createElement('td');
                            tdNonElementPower.textContent =
                                Math.round(character.atk * (1 + character.increaseAtk/100));
                            tr.appendChild(tdNonElementPower);

                            // 우코
                            const tdIncreaseElementDamage = document.createElement('td');
                            tdIncreaseElementDamage.textContent = character.increaseElementDamage;
                            tr.appendChild(tdIncreaseElementDamage);

                            // 공증
                            const tdIncreaseAtk = document.createElement('td');
                            tdIncreaseAtk.textContent = character.increaseAtk;
                            tr.appendChild(tdIncreaseAtk);

                            // ATK
                            const tdAtk = document.createElement('td');
                            tdAtk.textContent = character.atk;
                            tr.appendChild(tdAtk);

                            // Skill1
                            const tdSkill1 = document.createElement('td');
                            tdSkill1.textContent = character.skill1;
                            tr.appendChild(tdSkill1);

                            // Skill2
                            const tdSkill2 = document.createElement('td');
                            tdSkill2.textContent = character.skill2;
                            tr.appendChild(tdSkill2);

                            // Skill3
                            const tdSkill3 = document.createElement('td');
                            tdSkill3.textContent = character.skill3;
                            tr.appendChild(tdSkill3);

                            // 추가로 다른 스탯들도 필요하면 같은 방식으로 추가
                            tbody.appendChild(tr);
                        }
                    });
                });
            })
            .catch(error => console.error('JSON 파일 로딩 중 오류:', error));
    </script>
</body>

</html>